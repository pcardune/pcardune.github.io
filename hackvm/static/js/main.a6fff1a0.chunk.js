(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{64:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(20),o=n.n(r),i=(n(64),n(18)),c=n(26),u=n(7),m=n(39),l=n(53),h=n(54),d=n(22),b=n(55),g=n(36),v=n(21),j=n(13),p=n(38),f=n(27),w=n(32),O=n(59),_=n(43),x=n(3),y=function(e){var t=e.icon,n=e.label,a=Object(O.a)(e,["icon","label"]);return Object(x.jsxs)(_.a,Object(d.a)(Object(d.a)({},a),{},{children:[Object(x.jsx)("i",{className:"bi-"+t,role:"img","aria-label":n}),n]}))},G=n(57),k=n(15),S=n.n(k),T=n(25),N=n(35),D=n(41),A=n(42);var C=function(){function e(t){Object(D.a)(this,e),this.m=void 0,this.profile=void 0,this.numCycles=0,this.m=t,this.profile=!1}return Object(A.a)(e,[{key:"tick",value:function(e){this.profile?this.m.tick_profiled(e):this.m.tick(e),this.numCycles+=e}},{key:"reset",value:function(){this.m.reset(),this.numCycles=0,this.profile&&console.log(this.m.get_stats()),console.log(this.m.get_debug())}},{key:"setKeyboard",value:function(e){this.m.set_keyboard(e?function(e){var t=0;return void 0===(t={ArrowLeft:130,ArrowUp:131,ArrowRight:132,ArrowDown:133}[e])&&(t=e.charCodeAt(0)),t}(e.key):0)}},{key:"drawScreen",value:function(e){this.m.draw_screen(e)}},{key:"getVM",value:function(){return this.m}}],[{key:"create",value:function(){var t=Object(T.a)(S.a.mark((function t(a){var s,r,o,i,c;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.e(3).then(n.bind(null,82));case 2:(s=t.sent).init_panic_hook(),r=s.WebVM.new(),o=Object(N.a)(a.vmFiles);try{for(o.s();!(i=o.n()).done;)c=i.value,r.load_file(c.filename,c.text)}catch(u){o.e(u)}finally{o.f()}return r.init(),t.abrupt("return",new e(r));case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}(),I=function(){function e(){Object(D.a)(this,e),this.state={},this.subscribers={}}return Object(A.a)(e,[{key:"notifySubscribers",value:function(e){var t,n=this.subscribers[e]||[],a=Object(N.a)(n);try{for(a.s();!(t=a.n()).done;){(0,t.value)(Object(d.a)({},this.state[e]))}}catch(s){a.e(s)}finally{a.f()}}},{key:"subscribe",value:function(e,t){this.subscribers[e]||(this.subscribers[e]=[]),-1===this.subscribers[e].indexOf(t)&&(this.subscribers[e].push(t),t(this.state[e]))}},{key:"unsubscribe",value:function(e,t){this.subscribers[e]&&(this.subscribers[e]=this.subscribers[e].filter((function(e){return e!==t})))}},{key:"addFile",value:function(e,t){var n=this;return this.state[e]||(this.state[e]={loading:!0,error:null,url:e,data:""},fetch(e).then((function(t){t.ok?t.text().then((function(t){n.state[e]={loading:!1,error:null,url:e,data:t},n.notifySubscribers(e)})):(n.state[e]={loading:!1,error:t,url:e,data:""},n.notifySubscribers(e))}))),t&&this.subscribe(e,t),this.state[e]}},{key:"getFile",value:function(){var e=Object(T.a)(S.a.mark((function e(t){var n=this;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){n.addFile(t,(function s(r){r.loading||(r.error?(a(r),n.unsubscribe(t,s)):(e(r),n.unsubscribe(t,s)))}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFiles",value:function(){var e=Object(T.a)(S.a.mark((function e(t){var n,a,s,r,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=Object(N.a)(t),e.prev=2,a.s();case 4:if((s=a.n()).done){e.next=12;break}return r=s.value,e.next=8,this.getFile(r);case 8:o=e.sent,n.push(o);case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),a.e(e.t0);case 17:return e.prev=17,a.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"get",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function M(e,t){var n=setInterval((function(){try{e()}catch(t){throw clearInterval(n),t}}),t);return n}I.instance=void 0;var P=function(e){var t=e.urls,n=e.config,s=e.children,r=Object(a.useState)(n.speed),o=Object(i.a)(r,2),c=o[0],u=o[1],m=Object(a.useState)(0),l=Object(i.a)(m,2),h=l[0],d=l[1],b=Object(a.useState)(""),g=Object(i.a)(b,2),O=g[0],_=g[1],k=function(e,t){var n=t.speed,s=t.onTick,r=t.paused,o=void 0===r||r,c=Object(a.useState)(!1),u=Object(i.a)(c,2),m=u[0],l=u[1],h=Object(a.useState)(),d=Object(i.a)(h,2),b=d[0],g=d[1],v=Object(a.useState)(o),j=Object(i.a)(v,2),p=j[0],f=j[1],w=Object(a.useRef)(null);Object(a.useEffect)((function(){var t;f(o),g(void 0),l(!0);var n=null===(t=w.current)||void 0===t?void 0:t.getContext("2d");n&&n.clearRect(0,0,n.canvas.width,n.canvas.height),Object(T.a)(S.a.mark((function t(){var n,a;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.get().getFiles(e);case 2:return n=t.sent,a=n.map((function(e){var t=e.url.split("/");return{filename:t[t.length-1],text:e.data}})),t.t0=g,t.next=7,C.create({vmFiles:a});case 7:t.t1=t.sent,(0,t.t0)(t.t1),l(!1);case 10:case"end":return t.stop()}}),t)})))()}),[e]),Object(a.useEffect)((function(){if(b&&!p){var e,t=(new Date).getTime(),a=M((function(){null===b||void 0===b||b.tick(n)}),0);return s&&(e=M((function(){return s(b,(new Date).getTime()-t)}),1e3/30)),function(){e&&clearInterval(e),clearInterval(a)}}}),[b,p,s,n]),Object(a.useEffect)((function(){var e;if(!p&&b){var t=null===(e=w.current)||void 0===e?void 0:e.getContext("2d");if(t){var n=M((function(){b.drawScreen(t)}),1e3/30);return function(){clearInterval(n)}}}}),[p,b]);var O=Object(a.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),null===b||void 0===b||b.setKeyboard(e)}),[b]),_=Object(a.useCallback)((function(){return null===b||void 0===b?void 0:b.setKeyboard(null)}),[b]);return Object(a.useEffect)((function(){if(!p)return window.addEventListener("keydown",O),window.addEventListener("keyup",_),function(){window.removeEventListener("keydown",O),window.removeEventListener("keyup",_)}}),[p,O,_]),{machine:b,loading:m,canvasRef:w,paused:p,setPaused:f,reset:function(){var e;if(b){b.reset();var t=null===(e=w.current)||void 0===e?void 0:e.getContext("2d");t&&b.drawScreen(t),s&&s(b,0)}}}}(t,{paused:!1,speed:c,onTick:Object(a.useCallback)((function(e){d(e.numCycles/1e3)}),[])}),N=k.loading,D=k.canvasRef,A=k.paused,P=k.setPaused,E=k.reset,F=k.machine;Object(a.useEffect)((function(){u(n.speed),d(0)}),[t,n]);return Object(a.useEffect)((function(){if(F&&!A){var e=M((function(){_(null===F||void 0===F?void 0:F.getVM().get_debug())}),500);return function(){clearInterval(e)}}}),[F,A]),Object(x.jsxs)(v.a,{children:[Object(x.jsxs)(j.a,{md:8,children:[Object(x.jsx)(v.a,{children:Object(x.jsx)(j.a,{children:Object(x.jsx)("canvas",{ref:D,id:"myCanvas",width:"512",height:"256",style:{border:"1px solid black",width:"100%"}})})}),Object(x.jsxs)(v.a,{className:"justify-content-between",children:[Object(x.jsxs)(j.a,{xs:"auto",children:[Object(x.jsx)(y,{onClick:function(){A||P(!0),F&&(F.tick(1),_(F.getVM().get_debug()))},icon:"play-fill",label:"Tick",className:"mr-2"}),Object(x.jsx)(y,{onClick:function(){return P(!A)},label:A?"Play":"Pause",icon:A?"play-fill":"pause-fill",disabled:N,className:"mr-2"}),Object(x.jsx)(y,{icon:"arrow-counterclockwise",label:"Reset",onClick:E,disabled:h<=0,className:"mr-2"})]}),Object(x.jsx)(j.a,{xs:"5",children:N&&Object(x.jsxs)("span",{children:[Object(x.jsx)(G.a,{animation:"border",role:"status"})," Loading..."]})})]})]}),Object(x.jsxs)(j.a,{md:4,children:[s,Object(x.jsxs)(w.a,{defaultActiveKey:"1",children:[Object(x.jsxs)(f.a,{children:[Object(x.jsx)(w.a.Toggle,{as:f.a.Header,eventKey:"0",children:"Configuration"}),Object(x.jsx)(w.a.Collapse,{eventKey:"0",children:Object(x.jsx)(f.a.Body,{children:Object(x.jsx)(p.a,{children:Object(x.jsxs)(p.a.Group,{children:[Object(x.jsxs)(p.a.Label,{children:["Steps / Cycle: ",c]}),Object(x.jsx)(p.a.Control,{type:"range",min:500,max:1e5,value:c,className:"form-range",onChange:function(e){return u(parseInt(e.target.value))}})]})})})})]}),Object(x.jsxs)(f.a,{children:[Object(x.jsx)(w.a.Toggle,{as:f.a.Header,eventKey:"1",children:"Internal VM State"}),Object(x.jsx)(w.a.Collapse,{eventKey:"1",children:Object(x.jsx)(f.a.Body,{children:Object(x.jsx)("pre",{children:O})})})]})]})]})]})},E=["programs/OS/Array.vm","programs/OS/Keyboard.vm","programs/OS/Math.vm","programs/OS/Memory.vm","programs/OS/Output.vm","programs/OS/Screen.vm","programs/OS/String.vm","programs/OS/Sys.vm"],F={pong:{title:"Pong",description:"The classic game of pong that's part of the Nand2Tetris course.",author:"Noam Nisan and Shimon Schocken (creators of Nand2Tetris)",projectUrl:"https://www.nand2tetris.org/",instructions:"Use the arrow keys to move the paddle.",config:{speed:5e3},files:["programs/Pong/Bat.vm","programs/Pong/Ball.vm","programs/Pong/Main.vm","programs/Pong/PongGame.vm"]},hackenstein3D:{title:"Hackenstein 3D",description:"A (very) simple first-person shooter / 3D maze game.",author:"James Leibert",projectUrl:"https://github.com/QuesterZen/hackenstein3D",files:["https://raw.githubusercontent.com/QuesterZen/hackenstein3D/master/dist/Display.vm","https://raw.githubusercontent.com/QuesterZen/hackenstein3D/master/dist/Main.vm","https://raw.githubusercontent.com/QuesterZen/hackenstein3D/master/dist/Player.vm","https://raw.githubusercontent.com/QuesterZen/hackenstein3D/master/dist/Walls.vm"]},scroller:{title:"Scroller",description:"A demo of scrolling text across the screen.",author:"Gavin Stewart",projectUrl:"https://github.com/gav-/Nand2Tetris-Games_and_Demos",config:{speed:5e3},files:["https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASscroller/GASscroller.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASscroller/Main.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASscroller/MathsToo.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASscroller/MemoryToo.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASscroller/Sinus.vm"]},chunky:{title:"Chunky",description:"A real-time plasma and rotozoom demo.",author:"Gavin Stewart",projectUrl:"https://github.com/gav-/Nand2Tetris-Games_and_Demos",files:["https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/ChunkyImage.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Dither4x4.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/GASchunky.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Head.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Image.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Main.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/MathsToo.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/MemoryToo.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Monitor.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Plasma.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/RotoZoom.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASchunky/Sinus.vm"]},boing:{title:"Boing",description:"A bouncing ball animation.",author:"Gavin Stewart",projectUrl:"https://github.com/gav-/Nand2Tetris-Games_and_Demos",config:{speed:5e3},files:["https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/GASboing.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/Image.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/Main.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/MathsToo.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/MemoryToo.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/Sinus.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball01.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball02.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball03.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball04.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball05.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball06.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball07.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/ball08.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow01.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow02.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow03.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow04.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow05.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow06.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow07.vm","https://raw.githubusercontent.com/gav-/Nand2Tetris-Games_and_Demos/master/GASboing/shadow08.vm"]}};var L=function(){var e=Object(u.f)().demoId,t=F[void 0===e?"pong":e];if(!t)return Object(x.jsx)(g.a,{children:"No demo found at this url."});var n=t?[].concat(Object(b.a)(t.files),Object(b.a)(E)):[],a={speed:2e4},s=t&&t.config?Object(d.a)(Object(d.a)({},a),t.config):a;return Object(x.jsxs)(g.a,{children:[Object(x.jsx)(v.a,{children:Object(x.jsxs)(j.a,{md:12,children:[Object(x.jsx)("strong",{className:"fs-5",children:t.title})," - ",t.description," ",Object(x.jsx)("a",{href:t.projectUrl,target:"_blank",rel:"noopener noreferrer",children:"[source code]"}),Object(x.jsxs)("p",{children:["by ",t.author," "]})]})}),Object(x.jsx)(P,{urls:n,config:s,children:t.instructions&&Object(x.jsx)("p",{children:t.instructions})})]})};var B=function(){return Object(x.jsx)(g.a,{children:Object(x.jsx)(v.a,{children:Object(x.jsxs)(j.a,{md:{span:8,offset:2},children:[Object(x.jsx)("h3",{children:"About"}),Object(x.jsxs)("p",{children:["I recently finished reading"," ",Object(x.jsx)("a",{href:"https://www.nand2tetris.org/book",target:"_blank",rel:"noopener noreferrer",children:"The Elements of Computing Systems"}),", which walks through building a complete computing system from logic gates all the way through to the implementation of a high level programming language and basic operating system. The book is part of a course called"," ",Object(x.jsx)("a",{href:"https://www.nand2tetris.org/",target:"_blank",rel:"noopener noreferrer",children:"Nand to Tetris"}),", created by Noam Nisan and Shimon Schocken, which is taught online and in person."]}),Object(x.jsxs)("p",{children:["In an effort to continue the fun, and learn some more stuff, I decided to recreate the virtual machine emulator program that comes with the book in a way that will run inside a web browser, without having to download anything. The emulator is written in"," ",Object(x.jsx)("a",{href:"https://www.rust-lang.org/",target:"_blank",rel:"noopener noreferrer",children:"Rust"})," ","and compiled to"," ",Object(x.jsx)("a",{href:"https://webassembly.org/",target:"_blank",rel:"noopener noreferrer",children:"Web Assembly"}),", with some javascript glue code to handle canvas rendering and keyboard events."]}),Object(x.jsx)("p",{children:"Checkout some of the demo programs (which other people wrote) running on the emulator:"}),Object(x.jsx)("ul",{children:Object.keys(F).map((function(e){return Object(x.jsxs)("li",{children:[Object(x.jsx)(c.b,{to:"/emulator/".concat(e),children:F[e].title})," -"," ",F[e].description," By ",F[e].author,"."]},e)}))}),Object(x.jsxs)("p",{children:["All the source code for the virtual machine implementation and this website is available"," ",Object(x.jsx)("a",{href:"https://github.com/pcardune/hackvm",target:"_blank",rel:"noopener noreferrer",children:"on github"}),"."]})]})})})};var K=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],s=t[1],r=function(){s(!1)};return Object(x.jsxs)(c.a,{children:[Object(x.jsxs)(m.a,{bg:"light",expand:"lg",className:"mb-2",expanded:n,onToggle:function(e){s(e)},children:[Object(x.jsx)(m.a.Brand,{as:c.b,to:"/",children:"Nand2Tetris VM Emulator"}),Object(x.jsx)(m.a.Toggle,{}),Object(x.jsx)(m.a.Collapse,{id:"basic-navbar-nav",children:Object(x.jsxs)(h.a,{className:"mr-auto",role:"",children:[Object(x.jsx)(h.a.Link,{as:c.b,to:"/",children:"About"}),Object(x.jsx)(l.a,{title:"Demos",id:"basic-nav-dropdown",menuRole:"",focusFirstItemOnShow:!1,children:Object.keys(F).map((function(e){return Object(x.jsx)(l.a.Item,{onSelect:r,as:c.b,to:"/emulator/".concat(e),children:F[e].title},e)}))})]})})]}),Object(x.jsxs)(u.c,{children:[Object(x.jsx)(u.a,{path:"/emulator/:demoId",children:Object(x.jsx)(L,{})}),Object(x.jsx)(u.a,{path:"/emulator",children:Object(x.jsx)(L,{})}),Object(x.jsx)(u.a,{path:"/",children:Object(x.jsx)(B,{})})]})]})},R=function(e){e&&e instanceof Function&&n.e(4).then(n.bind(null,83)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),s(e),r(e),o(e)}))};o.a.render(Object(x.jsx)(s.a.StrictMode,{children:Object(x.jsx)(K,{})}),document.getElementById("root")),R()}},[[74,1,2]]]);
//# sourceMappingURL=main.a6fff1a0.chunk.js.map